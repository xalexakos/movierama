{% extends "movies/base.html" %}
{% load movies_extra %}
{% block userinfo %}
<span class="user">
    {% if not request.user.is_authenticated %}<a href="/user/login/">Login</a> or <a href="/user/registration/">Signup</a>
    {% else %}<span class="user-info">Welcome back <a href="/?user={{ request.user.id }}">{{ request.user.first_name }} {{ request.user.last_name }}</a></span>&nbsp;&nbsp;
    <a class="user-logout" href="/user/logout/">Logout</a>{% endif %}
</span>
{% endblock %}
{% block main %}
<div class="ordering">
    <span>Sort by</span>&nbsp;
    <a onclick="sortMovies('-likes')">Likes</a>
    <span class="separator">&#124;</span>
    <a onclick="sortMovies('-hates')">Hates</a>
    <span class="separator">&#124;</span>
    <a onclick="sortMovies('-created_at')">Date</a>
    {% if request.user.is_authenticated %}
    <span class="add-movie-btn"><a href="/add-movie/">New movie</a></span>
    {% endif %}
</div>
{% spaceless %}
    <div class="movies-list">
        {% if page_obj.paginator.num_pages > 1 %}
        <div class="page-ind"><span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.</span></div>
        {% endif %}
        {% if not movies %}
        <h3>No movies were found.</h3>
        {% else %}
        {% for movie in movies %}
        <div class="movie">
            <h2 class="title">{{ movie.title }}</h2>
            <span class="post-info">Posted by <a href="/?user={{ movie.user_id }}">
                {% if request.user.id == movie.user.id %}You{% else %}{{ movie.user.first_name }} {{ movie.user.last_name }}{% endif %}
            </a>&nbsp;{{ movie.get_created_repr }}</span>
            <p class="description">{{ movie.description }}</p>
            <span>{{ movie.likes }} likes</span><span class="separator">&#124;</span><span>{{ movie.hates }} hates</span>
        </div>
        {% endfor %}
        {% endif %}
    </div>
{% endspaceless %}
{% if page_obj.paginator.num_pages > 1 %}
<div class="center">
    <div id="pages" class="pagination">
        <a onclick="changePage(1)" class="page-number">&laquo;</a>
        {% for i in page_obj.paginator.num_pages|pages_range %}
        <a onclick="changePage({{ i }})" class="page-number">{{ i }}</a>
        {% endfor %}
        <a onclick="changePage({{ page_obj.paginator.num_pages }})" class="page-number">&raquo;</a>
    </div><br />
</div>
{% endif %}
{% endblock %}